ğŸš‚ Express.js Basics
1ï¸âƒ£ Typical app.js Structure (Production Style)
const express = require('express');
const app = express();

// ğŸ”¹ Middlewares
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// ğŸ”¹ Routes
const userRoutes = require('./routes/userRoutes');
const authRoutes = require('./routes/authRoutes');

app.use('/api/users', userRoutes);
app.use('/api/auth', authRoutes);

// ğŸ”¹ Default Route
app.get('/', (req, res) => {
  res.send('API is running');
});

// ğŸ”¹ Error Handling Middleware
app.use((err, req, res, next) => {
  res.status(500).json({ message: err.message });
});

// ğŸ”¹ Server
const PORT = 5000;
app.listen(PORT, () => {
  console.log(`Server running on port ${PORT}`);
});

2ï¸âƒ£ Folder Structure (MVC Pattern)
project/
â”‚
â”œâ”€â”€ app.js
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ userRoutes.js
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ userController.js
â”œâ”€â”€ models/
â”‚   â””â”€â”€ userModel.js
â””â”€â”€ middleware/
    â””â”€â”€ authMiddleware.js

3ï¸âƒ£ Routes (routes/userRoutes.js)
const express = require('express');
const router = express.Router();
const { getUsers, createUser } = require('../controllers/userController');

router.get('/', getUsers);
router.post('/', createUser);

module.exports = router;


ğŸ“Œ Routes only define endpoints
ğŸ“Œ No business logic here

4ï¸âƒ£ Controllers (controllers/userController.js)
exports.getUsers = (req, res) => {
  res.json({ users: [] });
};

exports.createUser = (req, res) => {
  const user = req.body;
  res.status(201).json({ user });
};


ğŸ“Œ Controllers contain business logic

5ï¸âƒ£ app.use() vs router.use() â­ (Very Important)
ğŸ”¹ app.use()

Used at application level
Applies to entire app or a base path

app.use(express.json());        // global middleware
app.use('/api/users', userRoutes);


âœ” Global middleware
âœ” Mount routers
âœ” Error handling

ğŸ”¹ router.use()

Used at router level
Applies only to specific routes

router.use(authMiddleware);

router.get('/profile', getProfile);


âœ” Route-specific middleware
âœ” Cleaner code
âœ” Better modularity

6ï¸âƒ£ Key Differences Table
Feature	app.use()	router.use()
Scope	Entire app	Specific router
Used in	app.js	route files
Middleware	Global	Route-specific
Common use	JSON parser, CORS	Auth, role checks
7ï¸âƒ£ Example: Auth Middleware
// middleware/auth.js
module.exports = (req, res, next) => {
  if (!req.headers.authorization) {
    return res.status(401).json({ message: 'Unauthorized' });
  }
  next();
};

Applied Globally
app.use(authMiddleware); âŒ

Applied to Router (Best)
router.use(authMiddleware); âœ…

ğŸ”¥ Interview Traps

âŒ Putting business logic in routes
âŒ Using app.use everywhere
âŒ Forgetting next()
âŒ Error middleware without 4 params

ğŸ¯ Interview One-Liners

app.js initializes server and middleware

Routes define API endpoints

Controllers handle logic

app.use() applies middleware globally

router.use() applies middleware locally